<!DOCTYPE html>
<html lang="en-us">

<head>

    <meta charset="UTF-8">
    <title>Train Time</title>
    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.4/firebase.js"></script>
    
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7"
        crossorigin="anonymous">
    <script src="https://www.gstatic.com/firebasejs/5.0.4/firebase.js"></script>


</head>

<body>

    <div class="container">

        <br>

        <!-- Jumbotron -->
        <div class="jumbotron">
            <h1 class="text-center">Anytime is Train Time
                <br>
            </h1>
            <h3 class="text-center">choo choo. chee chee</h3>
        </div>
        <div class="row">


            <!-- Most Recent Member Panel -->
            <div class="col-lg-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title" style="text-align: center;">Current Train Schedule</h3>
                        <br>

                        <body>

                            <center>
                                <table style="width:80%" id="directory">
                                    <tr>
                                        <th id="name">Train Name</th>
                                        <th id="destination">Destination</th>
                                        <th id="frequency">Frequency (min)</th>
                                        <th id="nextArival">Next Arrival</th>
                                        <th id="minutesAway">Minutes Away</th>
                                    </tr>
                                    <tbody id="addTrain"></tbody>
                                
                                </table>
                            </center>


                    </div>

                </div>


                <!-- Sign-Up Panel-->
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h2 class="panel-title">
                                <strong>Add Train</strong>
                            </h2>
                        </div>
                        <div class="panel-body">

                            <!-- Sign-up Form (note the various input "types")-->
                            <form role="form">
                                <div class="form-group">
                                    <label for="name-input">Train Name:</label>
                                    <input class="form-control" id="name-input" type="text">
                                </div>
                                <div class="form-group">
                                    <label for="destinations">Destination:</label>
                                    <input class="form-control" id="destinations" type="text">
                                </div>
                                <div class="form-group">
                                    <label for="trainFreq">Frequency (min):</label>
                                    <input class="form-control" id="trainFreq" type="number">
                                </div>
                                <div class="form-group">
                                    <label for="first-train">First Train Time (HH:mm - military time):</label>
                                    <input class="form-control" id="first-train" type="number">
                                </div>
                                <button class="btn btn-default" id="submit" type="submit">Submit</button>
                            </form>
                        </div>
                    </div>
                </div>


         
        <script>

        // creating an array that appends after click. 

        
  // Initialize Firebase
  
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyA4P1Lp7N7Nvs8eo0IXgYCaxqcTUnWR7Fc",
    authDomain: "train-time-7cdee.firebaseapp.com",
    databaseURL: "https://train-time-7cdee.firebaseio.com",
    projectId: "train-time-7cdee",
    storageBucket: "train-time-7cdee.appspot.com",
    messagingSenderId: "1023928771689"
  };

  firebase.initializeApp(config);




var database = firebase.database();





// start of javascript coding
var name = [];
var destination = [];
var frequency= 0;
var firstTrain = 0;
var tFrequency = 3;
var firstTime = 0;

//Capture Button Click
$("#submit").on("click", function (event) {
    event.preventDefault();
    name = $("#name-input").val().trim();
        console.log(name)
    destination = $("#destinations").val().trim();
        console.log(destination);
    frequency = $("#trainFreq").val().trim();
        console.log(frequency);
    firstTrain = $("#first-train").val().trim();
       alert("Train added!")
       
        console.log(rate);

//sends the information to firebase
    database.ref().push({
        name:name,
        destination: destination,
        frequency: frequency,
        firstTrain: firstTrain
    });
 
});
//displays the value typed in into the current employees box
    database.ref().on("child_added", function (snapshot){
        $("#addTrain").append("<tr><td>" + snapshot.val().name +"</td><td>" + snapshot.val().destination + "</td><td>" + snapshot.val().frequency + "</td><td>" + snapshot.val().firstTrain + "</td></tr>");
     

   // time frequency
  

// Time is 3:30 AM
//var firstTime = "03:30";

// First Time (pushed back 1 year to make sure it comes before current time)
var firstTimeConverted = moment(firstTrain, "HH:mm").subtract(1, "years");
console.log(firstTimeConverted);

// Current Time
var currentTime = moment();
console.log("CURRENT TIME: " + moment(currentTime).format("hh:mm"));

// Difference between the times
var diffTime = moment().diff(moment(firstTimeConverted), "minutes");
console.log("DIFFERENCE IN TIME: " + diffTime);

// Time apart (remainder)
var tRemainder = diffTime % tFrequency;
console.log(tRemainder);

// Minute Until Train
var tMinutesTillTrain = tFrequency - tRemainder;
console.log("MINUTES TILL TRAIN: " + tMinutesTillTrain);

// Next Train
var nextTrain = moment().add(tMinutesTillTrain, "minutes");
console.log("ARRIVAL TIME: " + moment(nextTrain).format("hh:mm"));

    });

    










                </script>









                </body>

</html>